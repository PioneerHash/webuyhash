<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>webuyhash.com</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <img src="img/hero.jpeg" alt="We Buy Hash" class="hero-image">
            <h1>webuyhash.com</h1>
            <div class="live-indicator">
                <span class="pulse"></span>
                <span class="live-text">LIVE</span>
                <span class="last-update" id="lastUpdate">--</span>
            </div>
        </header>

        <main>
            <!-- Network Stats Panel -->
            <section class="card network-stats">
                <h2>Network Stats</h2>
                <div class="stats-grid">
                    <div class="stat">
                        <span class="stat-label">Network Hashrate</span>
                        <span class="stat-value" id="networkHashrate">--</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Difficulty</span>
                        <span class="stat-value" id="difficulty">--</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Block Subsidy</span>
                        <span class="stat-value" id="blockSubsidy">3.125 BTC</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">Avg Tx Fees</span>
                        <span class="stat-value" id="avgBlockFees">--</span>
                    </div>
                </div>
            </section>

            <!-- Input Section -->
            <section class="card inputs">
                <h2>Pool Parameters</h2>
                <div class="var-legend">
                    <span class="legend-item"><code class="var-input">Your Input</code></span>
                    <span class="legend-item"><code class="var-network">Network Data</code></span>
                    <span class="legend-item"><code class="var-result">Calculated</code></span>
                </div>

                <!-- Hashrate Available -->
                <div class="input-group with-formula">
                    <div class="input-side">
                        <div class="input-header">
                            <label for="hashrate">Hashrate Available</label>
                            <button class="info-toggle" data-info="hashrate-info" aria-label="More info">?</button>
                        </div>
                        <div class="info-box" id="hashrate-info">
                            <p>The total hashrate your pool has access to from connected miners.</p>
                            <p>Your <code class="var-input">Hashrate Available</code> divided by the <code class="var-network">Network Hashrate</code> determines your <code class="var-result">Network Share %</code>.</p>
                            <span class="formula-block"><code class="var-result">Network Share</code> = <code class="var-input">Your Hashrate</code> ÷ <code class="var-network">Network Hashrate</code></span>
                        </div>
                        <div class="input-with-unit">
                            <input type="number" id="hashrate" value="10" min="0" step="0.1">
                            <select id="hashrateUnit">
                                <option value="TH">TH/s</option>
                                <option value="PH" selected>PH/s</option>
                                <option value="EH">EH/s</option>
                            </select>
                        </div>
                    </div>
                    <div class="formula-side">
                        <div class="formula-label">Network Share</div>
                        <div class="formula-display" id="hashrate-formula">
                            <span class="formula-equation">Your Hashrate ÷ Network Hashrate</span>
                            <span class="formula-values" id="hashrate-values">-- ÷ -- = --%</span>
                        </div>
                    </div>
                </div>

                <!-- Calculation Formula -->
                <div class="input-group with-formula">
                    <div class="input-side">
                        <div class="input-header">
                            <label for="formula">Calculation Formula</label>
                            <button class="info-toggle" data-info="formula-info" aria-label="More info">?</button>
                        </div>
                        <div class="info-box" id="formula-info">
                            <p><strong>Hashrate-ratio:</strong> Simpler and more intuitive.</p>
                            <span class="formula-block"><code class="var-result">Daily BTC</code> = (<code class="var-input">Your Hashrate</code> ÷ <code class="var-network">Network Hashrate</code>) × 144 × <code class="var-input">Block Reward</code></span>
                            <p><strong>Difficulty-based:</strong> Uses Bitcoin's difficulty target directly. Most mathematically precise.</p>
                            <span class="formula-block"><code class="var-result">Daily BTC</code> = (<code class="var-input">Hashrate</code> × <code class="var-input">Block Reward</code> × 86400) ÷ (<code class="var-network">Difficulty</code> × 2³²)</span>
                        </div>
                        <select id="formula">
                            <option value="difficulty">Difficulty-based</option>
                            <option value="hashrate" selected>Hashrate ratio</option>
                        </select>
                    </div>
                    <div class="formula-side">
                        <div class="formula-label">Daily BTC Formula</div>
                        <div class="formula-display" id="calc-formula">
                            <span class="formula-equation" id="calc-equation">(Hashrate ÷ Network) × 144 × Reward</span>
                            <span class="formula-values" id="calc-values">-- = -- BTC/day</span>
                        </div>
                    </div>
                </div>

                <!-- Block Reward (Subsidy + Fees) -->
                <div class="input-group with-formula">
                    <div class="input-side">
                        <div class="input-header">
                            <label for="blockRewardInput">Block Reward (BTC)</label>
                            <button class="info-toggle" data-info="reward-info" aria-label="More info">?</button>
                        </div>
                        <div class="info-box" id="reward-info">
                            <p>Total reward per block = <code class="var-network">Block Subsidy</code> + <code class="var-input">Tx Fees</code></p>
                            <p>The <code class="var-network">Block Subsidy</code> is fixed at 3.125 BTC (post-2024 halving). <code class="var-input">Tx Fees</code> vary based on network demand.</p>
                            <span class="formula-block"><code class="var-input">Block Reward</code> = <code class="var-network">3.125</code> (subsidy) + <code class="var-input">Fees</code></span>
                            <p><em>Default fees loaded from avg of last 15 blocks. Adjust to model different fee scenarios.</em></p>
                        </div>
                        <div class="reward-inputs">
                            <div class="reward-row">
                                <span class="reward-label">Subsidy:</span>
                                <span class="reward-value" id="subsidyDisplay">3.125</span>
                                <span class="reward-unit">BTC</span>
                            </div>
                            <div class="reward-row">
                                <span class="reward-label">+ Fees:</span>
                                <input type="number" id="txFees" value="0.15" min="0" step="0.01">
                                <span class="reward-unit">BTC</span>
                            </div>
                            <div class="reward-row reward-total">
                                <span class="reward-label">= Total:</span>
                                <span class="reward-value" id="totalRewardDisplay">3.275</span>
                                <span class="reward-unit">BTC</span>
                            </div>
                        </div>
                    </div>
                    <div class="formula-side">
                        <div class="formula-label">Block Reward Breakdown</div>
                        <div class="formula-display" id="reward-formula">
                            <span class="formula-equation">Subsidy (fixed) + Tx Fees (variable)</span>
                            <span class="formula-values" id="reward-values">3.125 + 0.15 = 3.275 BTC</span>
                        </div>
                    </div>
                </div>

                <!-- Pool Fee -->
                <div class="input-group with-formula">
                    <div class="input-side">
                        <div class="input-header">
                            <label for="poolFee">Pool Fee %</label>
                            <button class="info-toggle" data-info="poolfee-info" aria-label="More info">?</button>
                        </div>
                        <div class="info-box" id="poolfee-info">
                            <p>The percentage fee your pool charges miners. Industry standard is 1-3%.</p>
                            <p>Your <code class="var-input">Pool Fee %</code> is applied to the pool's <code class="var-result">Daily BTC Output</code> to calculate your <code class="var-result">Fee Revenue</code>.</p>
                            <span class="formula-block"><code class="var-result">Fee Revenue</code> = <code class="var-result">Daily BTC</code> × <code class="var-input">Fee %</code></span>
                        </div>
                        <div class="slider-input">
                            <input type="range" id="poolFeeSlider" min="0" max="10" step="0.1" value="2">
                            <input type="number" id="poolFee" value="2" min="0" max="10" step="0.1">
                            <span class="unit">%</span>
                        </div>
                    </div>
                    <div class="formula-side">
                        <div class="formula-label">Your Fee Revenue</div>
                        <div class="formula-display" id="fee-formula">
                            <span class="formula-equation">Pool's Total Daily BTC × Your Fee %</span>
                            <span class="formula-values" id="fee-values">-- × --% = --</span>
                        </div>
                    </div>
                </div>

            </section>

            <!-- Results Section -->
            <section class="card results">
                <div class="results-header">
                    <h2>Pool Revenue Projections</h2>
                    <div class="unit-toggle">
                        <button class="toggle-btn active" data-unit="btc">BTC</button>
                        <button class="toggle-btn" data-unit="sats">Sats</button>
                    </div>
                </div>

                <div class="pool-share">
                    <div class="share-stat">
                        <span class="share-label">Your % of Network</span>
                        <span class="share-value" id="networkShare">--</span>
                    </div>
                    <div class="share-stat">
                        <span class="share-label">Expected Blocks/Day</span>
                        <span class="share-value" id="expectedBlocks">--</span>
                    </div>
                </div>

                <div class="results-table-container">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Period</th>
                                <th id="amountHeader">BTC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Daily</td>
                                <td id="dailyAmount">--</td>
                            </tr>
                            <tr>
                                <td>Weekly</td>
                                <td id="weeklyAmount">--</td>
                            </tr>
                            <tr>
                                <td>Monthly</td>
                                <td id="monthlyAmount">--</td>
                            </tr>
                            <tr>
                                <td>Yearly</td>
                                <td id="yearlyAmount">--</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </section>

            <!-- Forward Projections Section -->
            <section class="card projections">
                <div class="results-header">
                    <h2>Forward Projections</h2>
                    <button class="info-toggle" data-info="projections-info" aria-label="More info">?</button>
                </div>
                <div class="info-box" id="projections-info">
                    <p>Model future revenue based on growth assumptions.</p>
                    <p>Your <code class="var-input">Hashrate Growth</code> compounds monthly on your starting hashrate. <code class="var-input">Network Growth</code> represents expected Bitcoin network expansion.</p>
                    <span class="formula-block"><code class="var-result">Future Share</code> = <code class="var-input">Your Hashrate</code> × (1 + growth)ⁿ ÷ <code class="var-network">Network</code> × (1 + net growth)ⁿ</span>
                </div>

                <!-- Quick Time Presets -->
                <div class="time-presets">
                    <span class="presets-label">Quick Select:</span>
                    <button class="preset-btn" data-preset="30d">30 Days</button>
                    <button class="preset-btn" data-preset="90d">90 Days</button>
                    <button class="preset-btn" data-preset="6m">6 Months</button>
                    <button class="preset-btn active" data-preset="1y">1 Year</button>
                    <button class="preset-btn" data-preset="2y">2 Years</button>
                    <button class="preset-btn" data-preset="3y">3 Years</button>
                    <button class="preset-btn" data-preset="ytd">YTD</button>
                    <button class="preset-btn" data-preset="next-halving">Next Halving</button>
                </div>

                <!-- Growth Assumptions -->
                <div class="assumptions-grid">
                    <div class="assumption-input">
                        <label for="projStartDate">Start Date</label>
                        <div class="input-row">
                            <input type="date" id="projStartDate">
                        </div>
                    </div>
                    <div class="assumption-input">
                        <label for="projEndDate">End Date</label>
                        <div class="input-row">
                            <input type="date" id="projEndDate">
                        </div>
                    </div>
                    <div class="assumption-input">
                        <label for="projGranularity">Time Granularity</label>
                        <div class="input-row">
                            <select id="projGranularity">
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly" selected>Monthly</option>
                            </select>
                        </div>
                    </div>
                    <div class="assumption-input">
                        <label for="poolGrowth">Your Hashrate Growth</label>
                        <div class="input-row">
                            <input type="number" id="poolGrowth" value="5" min="-50" max="100" step="0.5">
                            <span class="unit">% / month</span>
                        </div>
                    </div>
                    <div class="assumption-input">
                        <label for="networkGrowth">Network Hashrate Growth</label>
                        <div class="input-row">
                            <input type="number" id="networkGrowth" value="3" min="-20" max="50" step="0.5">
                            <span class="unit">% / month</span>
                        </div>
                    </div>
                </div>

                <!-- Projection Formulae -->
                <div class="projection-formulae">
                    <h3 class="subsection-title">Projection Formulae</h3>
                    <div class="formulae-grid">
                        <div class="formula-card">
                            <div class="formula-card-label">Future Pool Hashrate</div>
                            <div class="formula-card-equation">
                                <code class="var-result">H(t)</code> = <code class="var-input">H₀</code> × (1 + <code class="var-input">g</code>)<sup>t</sup>
                            </div>
                            <div class="formula-card-values" id="formulaPoolHashrate">
                                H₀ = -- | g = --% | t = -- periods
                            </div>
                        </div>
                        <div class="formula-card">
                            <div class="formula-card-label">Future Network Hashrate</div>
                            <div class="formula-card-equation">
                                <code class="var-result">N(t)</code> = <code class="var-network">N₀</code> × (1 + <code class="var-input">gₙ</code>)<sup>t</sup>
                            </div>
                            <div class="formula-card-values" id="formulaNetworkHashrate">
                                N₀ = -- | gₙ = --% | t = -- periods
                            </div>
                        </div>
                        <div class="formula-card">
                            <div class="formula-card-label">Future Network Share</div>
                            <div class="formula-card-equation">
                                <code class="var-result">S(t)</code> = <code class="var-result">H(t)</code> ÷ <code class="var-result">N(t)</code> × 100
                            </div>
                            <div class="formula-card-values" id="formulaShare">
                                Share changes from --% to --%
                            </div>
                        </div>
                        <div class="formula-card">
                            <div class="formula-card-label">Period Revenue</div>
                            <div class="formula-card-equation">
                                <code class="var-result">R(t)</code> = <code class="var-result">S(t)</code> × <code class="var-network">Blocks</code> × <code class="var-input">Reward</code> × <code class="var-input">Fee%</code>
                            </div>
                            <div class="formula-card-values" id="formulaRevenue">
                                144 blocks/day × -- BTC × --% fee
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Projections Table -->
                <div class="projections-controls">
                    <div class="pagination-info">
                        <span id="paginationInfo">Showing all results</span>
                    </div>
                    <div class="projections-actions">
                        <button class="action-btn" id="exportCsvBtn">Export CSV</button>
                    </div>
                </div>

                <div class="projections-table-container">
                    <table class="projections-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Period</th>
                                <th>Your Hashrate</th>
                                <th>Network</th>
                                <th>Share %</th>
                                <th>Period Revenue</th>
                                <th>Cumulative</th>
                            </tr>
                        </thead>
                        <tbody id="projectionsBody">
                            <!-- Populated by JavaScript -->
                        </tbody>
                        <tfoot>
                            <tr class="projections-total">
                                <td colspan="5">Total Projected Revenue</td>
                                <td id="projectionsTotalMonthly">--</td>
                                <td id="projectionsTotalCumulative">--</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <!-- Pagination -->
                <div class="pagination" id="pagination">
                    <button class="page-btn" id="prevPage" disabled>← Prev</button>
                    <span class="page-numbers" id="pageNumbers"></span>
                    <button class="page-btn" id="nextPage">Next →</button>
                </div>

                <!-- Quarterly Summary -->
                <h3 class="subsection-title">Quarterly Summary</h3>
                <div class="quarterly-grid" id="quarterlyGrid">
                    <!-- Populated by JavaScript -->
                </div>

            </section>

        </main>

        <footer>
            <p>Data from <a href="https://mempool.space" target="_blank">mempool.space</a> API</p>
            <p>webuyhash.com | Block <span id="blockHeight">--</span></p>
        </footer>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
